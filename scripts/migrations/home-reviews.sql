-- =============================================================================
-- –ú–∏–≥—Ä–∞—Ü–∏—è: home_reviews ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–∫—Ü–∏–∏ ¬´–û—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤¬ª –Ω–∞ –≥–ª–∞–≤–Ω–æ–π.
-- –ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å home_collections. –ó–∞–ø—É—Å–∫: Supabase SQL Editor.
-- =============================================================================

-- –¢–∞–±–ª–∏—Ü–∞ home_reviews (–æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏)
CREATE TABLE IF NOT EXISTS public.home_reviews (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  rating_count INT NOT NULL DEFAULT 50,
  rating_text TEXT,
  review2_text TEXT NOT NULL DEFAULT '–ü—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è —Ü–≤–µ—Ç–æ–≤. –ó–∞–∫–∞–∑—ã–≤–∞—é –±—É–∫–µ—Ç—ã –Ω–µ –ø–µ—Ä–≤—ã–π —Ä–∞–∑. –í—Å–µ –æ—á–µ–Ω—å —Å—Ç–∏–ª—å–Ω–æ, –∫—Ä–∞—Å–∏–≤–æ, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ. –†–∞–¥—É–µ—Ç –≥–ª–∞–∑ –∏ —Å–æ–≥—Ä–µ–≤–∞–µ—Ç –¥—É—à—É. –í—Å–µ, –∫–æ–º—É —è –¥–∞—Ä—é –±—É–∫–µ—Ç—ã –æ—Ç Flowerna, –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ! –û–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è. –ü–æ–º–∏–º–æ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å—Ç–∏–ª—è, –≤—Å–µ–≥–¥–∞ –≤—Å–µ —á–µ—Ç–∫–æ –∏ –≤–æ–≤—Ä–µ–º—è. –ß—Ç–æ —Ç–æ–∂–µ –æ—á–µ–Ω—å –∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ. –°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –¥–∞—Ä–∏—Ç–µ –∫—Ä–∞—Å–æ—Ç—É –∏ —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ',
  review3_text TEXT NOT NULL DEFAULT '–í—Å–µ–º —Å–µ—Ä–¥—Ü–µ–º –ª—é–±–ª—é Flowerna ‚ù§Ô∏è –¶–≤–µ—Ç–æ—á–Ω—ã–π —Å –æ—Å–æ–±–µ–Ω–Ω–æ–π, —Ç–µ–ø–ª–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–æ–π üòä –ë—É–∫–µ—Ç—ã –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞, –∫–∞–∂–¥—ã–π —Å–æ–∑–¥–∞–Ω —Å –¥—É—à–æ–π –∏ —Ç–æ–Ω–∫–∏–º —á—É–≤—Å—Ç–≤–æ–º –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ üòä –°–µ—Ä–≤–∏—Å Flowerna ‚Äì —ç—Ç–æ –≤—ã—Å—à–∏–π —É—Ä–æ–≤–µ–Ω—å, —Ç–∞–∫–æ–≥–æ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–≥–æ –∏ –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º —è —Ä–∞–Ω–µ–µ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–ª–∞ üòä Flowerna, –í—ã –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑—Ä—ã–≤ —Å–µ—Ä–¥—Ü–∞ ‚ù§Ô∏è –ñ–µ–ª–∞—é –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è —Ç–∞–∫–æ–º—É –∫—Ä—É—Ç–æ–º—É –±–∏–∑–Ω–µ—Å—É!!! ‚ù§Ô∏è',
  created_at TIMESTAMPTZ NOT NULL DEFAULT now(),
  updated_at TIMESTAMPTZ NOT NULL DEFAULT now()
);

-- –°–æ–∑–¥–∞–µ–º –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—É—é –∑–∞–ø–∏—Å—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
INSERT INTO public.home_reviews (rating_count, review2_text, review3_text)
SELECT 50, 
  '–ü—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –º–∞—Å—Ç–µ—Ä—Å–∫–∞—è —Ü–≤–µ—Ç–æ–≤. –ó–∞–∫–∞–∑—ã–≤–∞—é –±—É–∫–µ—Ç—ã –Ω–µ –ø–µ—Ä–≤—ã–π —Ä–∞–∑. –í—Å–µ –æ—á–µ–Ω—å —Å—Ç–∏–ª—å–Ω–æ, –∫—Ä–∞—Å–∏–≤–æ, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ. –†–∞–¥—É–µ—Ç –≥–ª–∞–∑ –∏ —Å–æ–≥—Ä–µ–≤–∞–µ—Ç –¥—É—à—É. –í—Å–µ, –∫–æ–º—É —è –¥–∞—Ä—é –±—É–∫–µ—Ç—ã –æ—Ç Flowerna, –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ! –û–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è. –ü–æ–º–∏–º–æ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Å—Ç–∏–ª—è, –≤—Å–µ–≥–¥–∞ –≤—Å–µ —á–µ—Ç–∫–æ –∏ –≤–æ–≤—Ä–µ–º—è. –ß—Ç–æ —Ç–æ–∂–µ –æ—á–µ–Ω—å –∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ. –°–ø–∞—Å–∏–±–æ –∑–∞ —Ç–æ, —á—Ç–æ –¥–∞—Ä–∏—Ç–µ –∫—Ä–∞—Å–æ—Ç—É –∏ —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ',
  '–í—Å–µ–º —Å–µ—Ä–¥—Ü–µ–º –ª—é–±–ª—é Flowerna ‚ù§Ô∏è –¶–≤–µ—Ç–æ—á–Ω—ã–π —Å –æ—Å–æ–±–µ–Ω–Ω–æ–π, —Ç–µ–ø–ª–æ–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–æ–π üòä –ë—É–∫–µ—Ç—ã –∫–∞–∫ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞, –∫–∞–∂–¥—ã–π —Å–æ–∑–¥–∞–Ω —Å –¥—É—à–æ–π –∏ —Ç–æ–Ω–∫–∏–º —á—É–≤—Å—Ç–≤–æ–º –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ üòä –°–µ—Ä–≤–∏—Å Flowerna ‚Äì —ç—Ç–æ –≤—ã—Å—à–∏–π —É—Ä–æ–≤–µ–Ω—å, —Ç–∞–∫–æ–≥–æ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–≥–æ –∏ –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º —è —Ä–∞–Ω–µ–µ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–ª–∞ üòä Flowerna, –í—ã –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑—Ä—ã–≤ —Å–µ—Ä–¥—Ü–∞ ‚ù§Ô∏è –ñ–µ–ª–∞—é –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è —Ç–∞–∫–æ–º—É –∫—Ä—É—Ç–æ–º—É –±–∏–∑–Ω–µ—Å—É!!! ‚ù§Ô∏è'
WHERE NOT EXISTS (SELECT 1 FROM public.home_reviews);

-- RLS
ALTER TABLE public.home_reviews ENABLE ROW LEVEL SECURITY;

DROP POLICY IF EXISTS "home_reviews_select_public" ON public.home_reviews;
CREATE POLICY "home_reviews_select_public" ON public.home_reviews
  FOR SELECT USING (true);

DROP POLICY IF EXISTS "home_reviews_service_all" ON public.home_reviews;
CREATE POLICY "home_reviews_service_all" ON public.home_reviews
  FOR ALL USING (auth.role() = 'service_role');
